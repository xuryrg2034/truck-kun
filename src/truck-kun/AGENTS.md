# AI Agents Instructions

> Главный файл инструкций для Claude Code. Читать АВТОМАТИЧЕСКИ при каждом запуске.

---

## Auto-Start Protocol

**При КАЖДОМ запуске новой сессии Claude Code ОБЯЗАН:**

1. **Автоматически прочитать этот файл** (`AGENTS.md`)
2. **Загрузить весь контекст** из директории `.claude/`:
   ```
   .claude/CONTEXT.md       → Структура и технологии проекта
   .claude/ARCHITECTURE.md  → Архитектура и паттерны
   .claude/TODO.md          → Текущие задачи
   .claude/CHANGELOG.md     → История изменений
   .claude/SESSION_NOTES.md → Заметки прошлой сессии
   ```
3. **Подтвердить загрузку** фразой:
   ```
   ✓ Контекст загружен из .claude/
   Проект: [название]
   Последнее изменение: [дата из CHANGELOG]
   Текущая задача: [из TODO или SESSION_NOTES]
   ```
4. **Ожидать задачу** от пользователя

**НЕ НАЧИНАЙ работу пока не выполнишь эти шаги!**

---

## After Every Change

### После КАЖДОГО изменения кода:

| Действие | Когда обновлять |
|----------|-----------------|
| `CHANGELOG.md` | **ВСЕГДА** после любого изменения файлов |
| `CONTEXT.md` | При изменении структуры, добавлении файлов/модулей |
| `ARCHITECTURE.md` | При изменении архитектуры, добавлении слоёв |
| `TODO.md` | При завершении задач, обнаружении багов, новых идеях |
| `SESSION_NOTES.md` | В конце сессии или при важных решениях |

### Формат записи в CHANGELOG:

```markdown
## YYYY-MM-DD HH:MM - [Краткое описание]

**Файлы:**
- `path/to/file.cs` - что изменено

**Причина:** Зачем это сделано
**Детали:** Важные нюансы реализации
```

---

## Working Principles

### Обязанности Claude Code:

1. **Поддержание документации**
   - Документация `.claude/` = твоя память между сессиями
   - Относись к ней как к критически важной системе
   - Неактуальная документация = потерянный контекст

2. **Качество изменений**
   - Изучи существующий код ПЕРЕД изменениями
   - Следуй установленным паттернам проекта
   - Не ломай работающий код без необходимости

3. **Коммуникация**
   - Объясняй свои решения
   - Предупреждай о рисках
   - Спрашивай при неясности

### При неопределённости:

1. **Проверь `.claude/`** - ответ может быть там
2. **Изучи существующий код** - найди похожие паттерны
3. **Спроси пользователя** - лучше уточнить, чем угадывать
4. **Документируй решение** - запиши в SESSION_NOTES.md

### Что НЕЛЬЗЯ делать:

- ❌ Начинать работу без загрузки контекста
- ❌ Изменять код без понимания архитектуры
- ❌ Забывать обновлять CHANGELOG
- ❌ Игнорировать установленные паттерны
- ❌ Делать "временные" решения без документирования

### Что НУЖНО делать:

- ✅ Всегда читать AGENTS.md при старте
- ✅ Обновлять .claude/ после каждого изменения
- ✅ Следовать архитектурным решениям проекта
- ✅ Писать код в стиле проекта
- ✅ Документировать неочевидные решения

---

## Quick Reference

### Ключевые файлы проекта:

| Цель | Файл |
|------|------|
| Конфигурация игры | `Assets/Code/Balance/GameBalance.cs` |
| Точка входа ECS | `Assets/Code/Infrastructure/EcsBootstrap.cs` |
| Порядок систем | `Assets/Code/Gameplay/BattleFeature.cs` |
| NPC логика | `Assets/Code/Gameplay/PedestrianFeature.cs` |
| Эффекты | `Assets/Code/Gameplay/FeedbackSystem.cs` |
| Анимации | `Assets/Code/Art/VFX/TweenSystem.cs` |

### Команды Git:

```bash
git status                    # Проверить изменения
git log --oneline -5          # Последние коммиты
git diff                      # Посмотреть изменения
```

---

## Context Files Location

```
truck-kun/
├── AGENTS.md                 ← ТЫ ЗДЕСЬ (читай первым!)
└── .claude/
    ├── CONTEXT.md            ← Структура проекта
    ├── ARCHITECTURE.md       ← Архитектура
    ├── TODO.md               ← Задачи
    ├── CHANGELOG.md          ← История
    └── SESSION_NOTES.md      ← Заметки сессии
```

---

**Помни: Эта система существует, чтобы ты мог эффективно работать между сессиями. Поддерживай её в актуальном состоянии!**
