---
tags: [flow, gameloop]
aliases: [Game Loop, игровой цикл]
related: [[Player-Progression]], [[Economy-Flow]]
---

# Game Loop

Основной цикл игры: Hub → Gameplay → Results → Hub.

## Сцены

| Сцена | Назначение |
|-------|------------|
| Hub | Гараж, магазин, подготовка |
| Gameplay | Основной геймплей |

## Flow дня

```
Hub Scene                    Gameplay Scene
┌─────────────────┐         ┌─────────────────┐
│  Start Day      │ ──────► │  ECS Bootstrap  │
│  (выбор машины) │         │  Initialize     │
└─────────────────┘         └────────┬────────┘
        ▲                            │
        │                            ▼
        │                   ┌─────────────────┐
        │                   │  Game Loop      │
        │                   │  (60 секунд)    │
        │                   └────────┬────────┘
        │                            │
        │                            ▼
        │                   ┌─────────────────┐
        │                   │  Day End        │
        │                   │  (результаты)   │
        │                   └────────┬────────┘
        │                            │
        └────────────────────────────┘
```

## Hub Scene

- Отображение баланса
- Панель улучшений ([[UpgradeService]])
- Панель квестов ([[QuestService]])
- Кнопка "Начать день"

## Gameplay Scene

1. **Initialize** — создание Hero, спавн пешеходов
2. **Execute** — каждый кадр: физика, столкновения, награды
3. **Cleanup** — удаление уничтоженных сущностей

## Day End

- Подсчёт заработка
- Проверка квестов
- Сохранение прогресса
- Переход в Hub

## Связанное

- [[Player-Progression]] — прогрессия между днями
- [[Economy-Flow]] — экономический баланс
